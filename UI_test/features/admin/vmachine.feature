Feature: vmachine

Scenario: 默认界面
Given I go to "http://127.0.0.1:5000/admin/"
Given I fill in "用户名" with "admin"
Given I fill in "密码" with "admin"
Given I press "登录"
Given I click "题目"
When I fill in "url" with "qemu+ssh://nana@127.0.0.1/system"
And I fill in "xml" with "/home/nana/ctf-platform/vmachine/"
And I press "连接服务器"
When I click "FreeDOS"
Then I should see "编辑虚拟机"
Then I click "注销 (admin)"

Scenario: 修改内存_1023
Given I go to "http://127.0.0.1:5000/admin/"
Given I fill in "用户名" with "admin"
Given I fill in "密码" with "admin"
Given I press "登录"
Given I click "题目"
When I fill in "url" with "qemu+ssh://nana@127.0.0.1/system"
And I fill in "xml" with "/home/nana/ctf-platform/vmachine/"
And I press "连接服务器"
When I click "FreeDOS"
And I fill the 2 input with number "1023"
And I press "修改虚拟机"
Then I should see "1023"
Then I click "注销 (admin)"

Scenario: 修改内存_1024
Given I go to "http://127.0.0.1:5000/admin/"
Given I fill in "用户名" with "admin"
Given I fill in "密码" with "admin"
Given I press "登录"
Given I click "题目"
When I fill in "url" with "qemu+ssh://nana@127.0.0.1/system"
And I fill in "xml" with "/home/nana/ctf-platform/vmachine/"
And I press "连接服务器"
When I click "FreeDOS"
And I fill the 2 input with number "1024"
And I press "修改虚拟机"
Then I should see "1024"
Then I click "注销 (admin)"

Scenario: 修改cpu_2
Given I go to "http://127.0.0.1:5000/admin/"
Given I fill in "用户名" with "admin"
Given I fill in "密码" with "admin"
Given I press "登录"
Given I click "题目"
When I fill in "url" with "qemu+ssh://nana@127.0.0.1/system"
And I fill in "xml" with "/home/nana/ctf-platform/vmachine/"
And I press "连接服务器"
When I click "FreeDOS"
And I fill the 3 input with number "2"
And I press "修改虚拟机"
Then I should see "2"
Then I click "注销 (admin)"

Scenario: 修改cpu_1
Given I go to "http://127.0.0.1:5000/admin/"
Given I fill in "用户名" with "admin"
Given I fill in "密码" with "admin"
Given I press "登录"
Given I click "题目"
When I fill in "url" with "qemu+ssh://nana@127.0.0.1/system"
And I fill in "xml" with "/home/nana/ctf-platform/vmachine/"
And I press "连接服务器"
When I click "FreeDOS"
And I fill the 3 input with number "1"
And I press "修改虚拟机"
Then I should see "1"
Then I click "注销 (admin)"

Scenario: 修改状态_running
Given I go to "http://127.0.0.1:5000/admin/"
Given I fill in "用户名" with "admin"
Given I fill in "密码" with "admin"
Given I press "登录"
Given I click "题目"
When I fill in "url" with "qemu+ssh://nana@127.0.0.1/system"
And I fill in "xml" with "/home/nana/ctf-platform/vmachine/"
And I press "连接服务器"
When I click "FreeDOS"
And I check the checkbox which id is "vmachine-running"
And I press "修改虚拟机"
Then I should see "running"
Then I click "注销 (admin)"

Scenario: 修改状态_suspend
Given I go to "http://127.0.0.1:5000/admin/"
Given I fill in "用户名" with "admin"
Given I fill in "密码" with "admin"
Given I press "登录"
Given I click "题目"
When I fill in "url" with "qemu+ssh://nana@127.0.0.1/system"
And I fill in "xml" with "/home/nana/ctf-platform/vmachine/"
And I press "连接服务器"
When I click "FreeDOS"
And I check the checkbox which id is "vmachine-suspend"
And I press "修改虚拟机"
Then I should see "suspend"
Then I click "注销 (admin)"

Scenario: 修改状态_resume
Given I go to "http://127.0.0.1:5000/admin/"
Given I fill in "用户名" with "admin"
Given I fill in "密码" with "admin"
Given I press "登录"
Given I click "题目"
When I fill in "url" with "qemu+ssh://nana@127.0.0.1/system"
And I fill in "xml" with "/home/nana/ctf-platform/vmachine/"
And I press "连接服务器"
When I click "FreeDOS"
And I check the checkbox which id is "vmachine-resume"
And I press "修改虚拟机"
Then I should see "running"
Then I click "注销 (admin)"

Scenario: 修改状态_shutdown
Given I go to "http://127.0.0.1:5000/admin/"
Given I fill in "用户名" with "admin"
Given I fill in "密码" with "admin"
Given I press "登录"
Given I click "题目"
When I fill in "url" with "qemu+ssh://nana@127.0.0.1/system"
And I fill in "xml" with "/home/nana/ctf-platform/vmachine/"
And I press "连接服务器"
When I click "FreeDOS"
And I check the checkbox which id is "vmachine-shutdown"
And I press "修改虚拟机"
Then I should see "shutdown"
Then I click "注销 (admin)"